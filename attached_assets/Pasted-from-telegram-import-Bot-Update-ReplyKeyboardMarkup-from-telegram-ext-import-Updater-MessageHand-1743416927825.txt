from telegram import Bot, Update, ReplyKeyboardMarkup
from telegram.ext import Updater, MessageHandler, Filters, CallbackContext, CommandHandler
import os

# === –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã ===
TELEGRAM_TOKEN = os.getenv("TELEGRAM_BOT_TOKEN")

WELCOME_MESSAGE = (
    "üëã –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º! –Ø –°–µ–∫—Ä–µ—Ç–∞—Ä—å –î–æ–∫—Ç–æ—Ä–∞ –•—É ü§ì\n"
    "–ó–∞–¥–∞–π—Ç–µ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å ‚Äî —è –≤—Å—ë —Ä–∞—Å—Å–∫–∞–∂—É!\n"
    "–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–≤—è–∑–∞—Ç—å—Å—è —Å —á–µ–ª–æ–≤–µ–∫–æ–º ‚Äî –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É üëá"
)

AUTO_RESPONSES = {
    "—Ü–µ–Ω–∞": "üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ–∑–æ–Ω–∞, –∫–ª–∏–Ω–∏–∫–∏ –∏ –∞–∫—Ü–∏–π. –î–∞–≤–∞–π—Ç–µ –æ–±—Å—É–¥–∏–º –≤ –ª–∏—á–∫–µ ‚Äî –Ω–∞–ø–∏—à–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞!",
    "—Å—Ç–æ–∏–º–æ—Å—Ç—å": "üí¨ –¢–æ—á–Ω—É—é —Ü–µ–Ω—É –º–æ–≥—É –ø–æ–¥—Å–∫–∞–∑–∞—Ç—å –≤ –ª–∏—á–∫–µ, —Ç–∞–∫ –∫–∞–∫ –≤—Å—ë –º–µ–Ω—è–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Å–ª—É–≥ –∏ —Å–µ–∑–æ–Ω–∞.",
    "–∫–∞–∫ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è": "üìù –ù–∞–ø–∏—à–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω ‚Äî —è –ø–µ—Ä–µ–¥–∞–º –≤–∞—Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.",
    "–≥–¥–µ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å": "üìç –ú—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è –≤ –≥–æ—Ä–æ–¥–µ –•—É–Ω—å—á—É–Ω—å, –ö–∏—Ç–∞–π. –†–∞–±–æ—Ç–∞–µ–º —É–∂–µ –±–æ–ª–µ–µ 25 –ª–µ—Ç!",
    "–≤–∏–∑–∞": "üõÇ –ú—ã –æ—Ñ–æ—Ä–º–ª—è–µ–º –≤–∏–∑–æ–≤—ã–µ —Ç—É—Ä—ã –ø–æ –ö–∏—Ç–∞—é. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ –∏ –≤ –≥—Ä—É–ø–ø–µ ‚Äî –≤—Å—ë —Å–¥–µ–ª–∞–µ–º –∫—Ä–∞—Å–∏–≤–æ üòä"
}

# === –§—É–Ω–∫—Ü–∏–∏ ===

def start(update: Update, context: CallbackContext):
    chat_id = update.effective_chat.id
    message = context.bot.send_message(chat_id=chat_id, text=WELCOME_MESSAGE)
    try:
        context.bot.pin_chat_message(chat_id=chat_id, message_id=message.message_id)
    except:
        pass  # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –±–æ—Ç –Ω–µ –º–æ–∂–µ—Ç –∑–∞–∫—Ä–µ–ø–∏—Ç—å


def handle_message(update: Update, context: CallbackContext):
    text = update.message.text.lower()
    for key, response in AUTO_RESPONSES.items():
        if key in text:
            update.message.reply_text(response)
            return
    # –ï—Å–ª–∏ –Ω–µ—Ç –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç–∞ ‚Äî –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å ChatGPT –∑–¥–µ—Å—å:
    update.message.reply_text("–î–æ–∫—Ç–æ—Ä –•—É –¥—É–º–∞–µ—Ç... ü§î (–æ—Ç–≤–µ—Ç –æ—Ç OpenAI –±—É–¥–µ—Ç –∑–¥–µ—Å—å)")  # <-- –∑–∞–≥–ª—É—à–∫–∞

# === –ó–∞–ø—É—Å–∫ ===

def main():
    updater = Updater(token=TELEGRAM_TOKEN, use_context=True)
    dispatcher = updater.dispatcher

    dispatcher.add_handler(CommandHandler("start", start))
    dispatcher.add_handler(MessageHandler(Filters.text & (~Filters.command), handle_message))

    updater.start_polling()
    updater.idle()

if __name__ == '__main__':
    main()
